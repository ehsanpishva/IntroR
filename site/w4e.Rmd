---
title: "Introduction to R | PSY4373"
subtitle: "Week 4 - Extra"
output: html_document
---

---

### Self-Study

There is no self-study part for this week.

---

### Excercise 4

For the exercise, you will need this dataset:

- [mirnadata.rdata](FIX ME!)

1. The code for a differential miRNA expression analysis of Alzheimers disease post-mortem brains are pasted below.

```{r c1, eval = FALSE}
#setwd("")

load("mirnadata.rdata")

res <- matrix(data=NA, nrow=490, ncol=4)

for (i in 2:491){
   fit <- lm(dat[,i] ~ Braak, data=dat)
   res[i-1,] <- coef(summary(fit))[2,]
}

colnames(res) <- c("Estimate","SE","t","p-value")
rownames(res) <- colnames(dat)[2:491]
res <- res[order(res[,4]),]
```

2. Install the package [multiMiR](https://www.bioconductor.org/packages/release/bioc/html/multiMiR.html) with:

```{r c2, eval = FALSE}
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")

BiocManager::install("multiMiR")
```

3. Use the `get_multimir` function from the package and extract the validated mRNA targets for the top (i.e., most significant) two deferentially expressed miRNAs in association with AD pathology.

4. Generate a vector from the column called `target_entrez` in the table of results return by `get_multimir` function.

5. Install packages [clusterProfiler](https://bioconductor.org/packages/release/bioc/html/clusterProfiler.html) and [org.Hs.eg.db](https://bioconductor.org/packages/release/data/annotation/html/org.Hs.eg.db.html) with:

```{r c3, eval = FALSE}
BiocManager::install("clusterProfiler")
BiocManager::install("org.Hs.eg.db")
```

6. Use the `enrichKEGG` function and use the vector you generated from the `target_entrez` as input.

7. Write the table of KEGG pathway analysis and upload that together with you script.

---

### **Solution**

Go to the link below if you want to compare your script to the solution.

[Solution script GitHub](https://github.com/ehsanpishva/IntroR-PSY4373/blob/main/Scripts/IntroR_solution_exercise_4.R)

[Solution script RAW](https://raw.githubusercontent.com/ehsanpishva/IntroR-PSY4373/main/Scripts/IntroR_solution_exercise_4.R)
